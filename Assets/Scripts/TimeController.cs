using UnityEngine;

public class TimeController : MonoBehaviour
{
    // Start is called once before the first execution of Update after the MonoBehaviour is created
    
    //カウントダウンにするかどうかのフラグ
    //falseならカウントアップ
    public bool isCountDown = true;

    //ゲームの基準となる時間
    public float gameTime = 0;

    //カウントを止めるかどうかのフラグ
    //falseならカウントし続ける、trueならカウント終了
    public bool isTimeOver = false;

    //ユーザーに見せる時間
    public float displayTime = 0;

    //ゲームの経過時間
    float times = 0;

    void Start()
    {
        if (isCountDown)
        {
            displayTime = gameTime;
        
        }
        
    }


    // Update is called once per frame
    void Update()
    {
        if (!isTimeOver)
        {
            //停止フラグがたっていないので処理したいが、ゲームステータスがplayingでなくなったときは止めたい
            if (GameManager.gameState != "playing")
            {
                isTimeOver = true; //停止フラグをon
            
            }

            //カウントの処理する
            //経過時間の蓄積
            times += Time. deltaTime; //デルタタイムの蓄積

            if (isCountDown)
            {
                //ユーザーに見せたい時間（残時間）残時間に（基準時間-経過時間）を代入
                displayTime = gameTime - times;

                if (displayTime <= 0)
                {
                    displayTime = 0; //0表記に統一
                    isTimeOver = true; //停止タイマーをon
                    GameManager.gameState = "gameover";
                }
            }
            else //カウントアップ形式だった場青
            {
                displayTime = times; //経過時間をユーザーに見せたい時間に代入
                if (displayTime >= gameTime)
                {
                    //ユーザーに見せたい時間を基準時間にする
                    displayTime = gameTime;
                    isTimeOver = true; //停止フラグをon
                    GameManager.gameState = "gameover";
                
                }

            
            }

        
        }
        
    }
}
